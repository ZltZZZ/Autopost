<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Профиль</title>
        <style>
            * {
                box-sizing: border-box;
                font-family: Arial, sans-serif;
            }

            body {
                margin: 0;
                padding: 20px;
                background-color: #f5f5f5;
                display: flex;
                justify-content: center;
            }

            .profile-container {
                max-width: 800px;
                width: 100%;
                background-color: white;
                border-radius: 10px;
                padding: 20px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                display: flex;
                flex-direction: column;
            }

            .profile-header {
                margin-bottom: 30px;
            }

            .profile-actions {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }

            .btn {
                padding: 10px 15px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                transition: background-color 0.3s;
                text-align: center;
            }

            .btn-primary {
                background-color: #4285f4;
                color: white;
            }

            .btn-primary:hover {
                background-color: #3367d6;
            }

            .btn-secondary {
                background-color: #f1f1f1;
                color: #333;
            }

            .btn-secondary:hover {
                background-color: #e0e0e0;
            }

            .tokens-section {
                margin-top: 20px;
            }

            .token-input-group {
                margin-bottom: 15px;
            }

            .token-input-group label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
            }

            .token-input {
                width: 100%;
                padding: 8px 10px;
                border: 1px solid #ddd;
                border-radius: 5px;
                font-size: 14px;
            }

            .save-tokens-btn {
                margin-top: 10px;
                display: none;
            }

            .password-modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                justify-content: center;
                align-items: center;
                z-index: 1000;
            }

            .modal-content {
                background-color: white;
                padding: 20px;
                border-radius: 8px;
                width: 90%;
                max-width: 400px;
            }

            .modal-title {
                margin-top: 0;
                margin-bottom: 20px;
            }

            .form-group {
                margin-bottom: 15px;
            }

            .form-group label {
                display: block;
                margin-bottom: 5px;
            }

            .form-group input {
                width: 100%;
                padding: 8px 10px;
                border: 1px solid #ddd;
                border-radius: 5px;
            }

            .modal-actions {
                display: flex;
                justify-content: flex-end;
                gap: 10px;
                margin-top: 20px;
            }

            #fileInput {
                display: none;
            }

            .back-btn {
                margin-top: 20px;
            }

            /* Стили для контейнера сессий (сохраняем ваши оригинальные) */
            .sessions-container {
                margin-top: 20px;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                padding: 15px;
                background-color: #fff;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            }

            .sessions-title {
                margin-top: 0;
                margin-bottom: 15px;
                font-size: 18px;
                color: #333;
            }

            /* Обновленные стили для session-item (компромиссный вариант) */
            .session-item {
                display: grid;
                grid-template-columns: 1fr auto;
                gap: 15px;
                padding: 12px;
                border-bottom: 1px solid #f0f0f0;
                align-items: center;
            }

            .session-item:last-child {
                border-bottom: none;
            }

            .session-details {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 8px 15px;
            }

            .session-detail {
                font-size: 14px;
                line-height: 1.4;
            }

            .session-detail-label {
                font-weight: bold;
                color: #555;
                display: block;
                margin-bottom: 2px;
                font-size: 13px;
            }

            /* Сохраняем ваши оригинальные стили кнопки с небольшими улучшениями */
            .terminate-session-btn {
                background-color: #f44336;
                color: white;
                border: none;
                border-radius: 4px;
                padding: 8px 12px;
                cursor: pointer;
                font-size: 13px;
                transition: background-color 0.2s;
                height: fit-content;
            }

            .terminate-session-btn:hover {
                background-color: #d32f2f;
            }

            /* Адаптация для мобильных устройств */
            @media (max-width: 600px) {
                .session-item {
                    grid-template-columns: 1fr;
                }

                .session-details {
                    grid-template-columns: 1fr;
                }

                .terminate-session-btn {
                    justify-self: start;
                    margin-top: 10px;
                }
            }

            .temporary-link-container {
                margin-top: 20px;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                padding: 15px;
                background-color: #fff;
            }

            .temporary-link-title {
                margin-top: 0;
                margin-bottom: 15px;
                font-size: 18px;
            }

            .temporary-link-controls {
                display: flex;
                gap: 10px;
                margin-bottom: 15px;
            }

            .temporary-link-input {
                flex-grow: 1;
                padding: 8px 10px;
                border: 1px solid #ddd;
                border-radius: 4px;
                background-color: #f9f9f9;
            }

            .temporary-link-options {
                display: flex;
                gap: 10px; /* Горизонтальный отступ между элементами */
                margin-bottom: 15px;
                align-items: center;
            }

            .duration-select {
                padding: 8px 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                width: auto; /* Автоматическая ширина по содержимому */
                min-width: 150px; /* Минимальная комфортная ширина */
                max-width: 250px; /* Максимальная ширина */
                flex-shrink: 0; /* Запрещаем сжатие */
            }

            #generateLinkBtn {
                white-space: nowrap; /* Текст в одну строку */
                padding: 8px 16px;
            }

            .link-expiration-info {
                margin-top: 10px;
                font-size: 14px;
                color: #666;
            }

            .btn-danger {
                background-color: #dc3545;
                color: white;
            }
            .btn-danger:hover {
                background-color: #c82333;
            }

            /* Мобильные стили только для исправления кнопки */
            @media (max-width: 768px) {
                .temporary-link-controls {
                    flex-wrap: wrap;
                }

                .temporary-link-input {
                    min-width: 100%; /* Занимает всю ширину */
                    margin-bottom: 8px; /* Отступ между полем и кнопкой */
                }

                #copyLinkBtn {
                    width: 100%; /* Кнопка на всю ширину */
                }

                .temporary-link-options {
                    flex-direction: column;
                    gap: 12px; /* Увеличиваем вертикальный отступ */
                    align-items: stretch; /* Растягиваем на всю ширину */
                }

                .duration-select {
                    max-width: 100%; /* На мобильных - на всю ширину */
                    width: 100%;
                    padding: 10px 12px; /* Увеличиваем для удобства касания */
                }

                #generateLinkBtn {
                    width: 100%;
                    padding: 10px; /* Увеличиваем область касания */
                    margin-top: 8px; /* Дополнительный отступ сверху */
                }
            }
        </style>
    </head>
    <body>
        <div class="profile-container">
            <h1>Профиль</h1>

            <div class="profile-header">
                <div class="profile-actions">
                    <button id="changePasswordBtn" class="btn btn-secondary">Новый пароль</button>
                    <button id="editPostBtn" class="btn btn-secondary">Редактировать new пост</button>
                    <a class="btn btn-danger" href="/api/auth/logout" role="button">Выход</a>

                    <!-- Контейнер активных сессий -->
                    <div class="sessions-container">
                        <h3 class="sessions-title">Активные сессии</h3>
                        <div id="sessionsList">
                            <!-- Сюда будут динамически добавляться сессии -->
                        </div>
                    </div>

                    <div class="temporary-link-container">
                        <h3 class="temporary-link-title">Временная ссылка</h3>
                        <div class="temporary-link-controls">
                            <input type="text" id="temporaryLinkInput" class="temporary-link-input" readonly placeholder="Сгенерируйте ссылку..." />
                            <button id="copyLinkBtn" class="btn btn-secondary">Копировать</button>
                        </div>
                        <div class="temporary-link-options">
                            <select id="durationSelect" class="duration-select">
                                <option value="15">15 минут</option>
                                <option value="60">1 час</option>
                                <option value="1440">1 день</option>
                                <option value="10080">1 неделя</option>
                            </select>
                            <button id="generateLinkBtn" class="btn btn-primary">Сгенерировать ссылку</button>
                            <button id="revokeLinkBtn" class="btn btn-danger" style="display: none;">Отозвать ссылку</button>
                        </div>
                        <div id="linkExpirationInfo" class="link-expiration-info"></div>
                    </div>
                </div>
            </div>

            <div class="tokens-section">
                <h2>Токены социальных сетей</h2>

                <div class="token-input-group">
                    <label for="telegramBotToken">Telegram Bot Token</label>
                    <input type="text" id="telegramBotToken" class="token-input" placeholder="Введите токен Telegram" />
                </div>
                <div class="token-input-group">
                    <label for="telegramChatId">Telegram chat id</label>
                    <input type="text" id="telegramChatId" class="token-input" placeholder="Введите токен Telegram" />
                </div>

                <div class="token-input-group">
                    <label for="vkGroupToken">VK Group Token</label>
                    <input type="text" id="vkGroupToken" class="token-input" placeholder="Введите токен ВКонтакте" />
                </div>
                <div class="token-input-group">
                    <label for="vkUserToken">VK User Token</label>
                    <input type="text" id="vkUserToken" class="token-input" placeholder="Введите токен ВКонтакте" />
                </div>

                <div class="token-input-group">
                    <label for="okGroupToken">OK Group Token</label>
                    <input type="text" id="okGroupToken" class="token-input" placeholder="Введите токен Одноклассников" />
                </div>

                <button id="saveTokensBtn" class="btn btn-primary save-tokens-btn">Сохранить токены</button>
            </div>

            <div class="back-btn">
                <button id="backBtn" class="btn btn-secondary">Назад</button>
            </div>
        </div>

        <!-- Модальное окно для смены пароля -->
        <div id="passwordModal" class="password-modal">
            <div class="modal-content">
                <h3 class="modal-title">Введите новый пароль</h3>

                <div class="form-group">
                    <label for="newPassword">Новый пароль</label>
                    <input type="password" id="newPassword" class="token-input" placeholder="Введите новый пароль" />
                </div>

                <div class="modal-actions">
                    <button id="cancelPasswordBtn" class="btn btn-secondary">Отмена</button>

                    <button id="confirmPasswordBtn" class="btn btn-primary">Сохранить</button>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Элементы страницы
                const changePasswordBtn = document.getElementById("changePasswordBtn");
                const editPostBtn = document.getElementById("editPostBtn");
                const backBtn = document.getElementById("backBtn");
                const saveTokensBtn = document.getElementById("saveTokensBtn");
                const tokenInputs = document.querySelectorAll(".token-input");
                const terminateSessionBtns = document.querySelectorAll(".terminate-session-btn");

                // Элементы модального окна
                const passwordModal = document.getElementById("passwordModal");
                const newPasswordInput = document.getElementById("newPassword");
                const cancelPasswordBtn = document.getElementById("cancelPasswordBtn");
                const confirmPasswordBtn = document.getElementById("confirmPasswordBtn");

                // Состояние
                let originalTokens = {};

                const temporaryLinkInput = document.getElementById("temporaryLinkInput");
                const copyLinkBtn = document.getElementById("copyLinkBtn");
                const generateLinkBtn = document.getElementById("generateLinkBtn");
                const durationSelect = document.getElementById("durationSelect");
                const linkExpirationInfo = document.getElementById("linkExpirationInfo");
                const revokeLinkBtn = document.getElementById("revokeLinkBtn");
                
                let profileId = null;
                let linkId = null;

                // Показываем/скрываем кнопку отзыва
                function updateRevokeButtonVisibility() {
                    revokeLinkBtn.style.display = temporaryLinkInput.value ? "block" : "none";
                }

                // Обработчик клика на кнопку отзыва
                revokeLinkBtn.addEventListener("click", function () {
                    if (confirm("Вы уверены, что хотите отозвать временную ссылку?")) {
                        fetch(`/api/profile/${profileId}/temp-links/${linkId}`, {
                            method: "DELETE",
                            headers: {
                                "X-CSRFToken": getCookie("csrftoken"),
                            },
                        })
                            .then((response) => {
                                if (response.ok) {
                                    temporaryLinkInput.value = "";
                                    linkExpirationInfo.textContent = "";
                                    revokeLinkBtn.style.display = "none";
                                    linkId = null;
                                    alert("Ссылка успешно отозвана");
                                } else {
                                    alert("Ошибка при отзыве ссылки");
                                }
                            })
                            .catch((error) => {
                                console.error("Error revoking link:", error);
                                alert("Произошла ошибка при отзыве ссылки");
                            });
                    }
                });

                // Копирование ссылки
                copyLinkBtn.addEventListener("click", function () {
                    temporaryLinkInput.select();
                    document.execCommand("copy");
                    alert("Ссылка скопирована в буфер обмена");
                });

                // Генерация ссылки
                generateLinkBtn.addEventListener("click", function () {
                    const duration = parseInt(durationSelect.value);

                    fetch(`/api/profile/${profileId}/temp-links`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/x-www-form-urlencoded",
                            "X-CSRFToken": getCookie("csrftoken"),
                        },
                        body: new URLSearchParams({ duration: duration.toString() }),
                    })
                        .then((response) => response.json())
                        .then((data) => {
                            if (data.success) {
                                temporaryLinkInput.value = data.link;
                                const expiresAt = new Date(data.expires_at);
                                linkExpirationInfo.textContent = `Ссылка действительна до: ${expiresAt.toLocaleString()}`;
                                linkId = data.linkId;
                                revokeLinkBtn.style.display = "block"; // Показываем кнопку отзыва
                            } else {
                                alert("Ошибка при генерации ссылки");
                            }
                        })
                        .catch((error) => {
                            console.error("Error generating link:", error);
                            alert("Произошла ошибка при генерации ссылки");
                        });
                });

                // Загрузка данных профиля
		function loadProfileData() {
		    // 1. Получаем ID профиля
		    fetch("/api/profile", {
			headers: {
			    "X-CSRFToken": getCookie("csrftoken"),
			},
		    })
		    .then(response => response.json())
		    .then(data => {
			if (!data.user_id) {
			    throw new Error("User ID not received");
			}
			profileId = data.user_id;
			
			// 2. Получаем сессии
			return fetch(`/api/profile/${profileId}/sessions`, {
			    headers: {
				"X-CSRFToken": getCookie("csrftoken"),
			    },
			})
			.then(response => response.json())
			.then(sessionsData => {
			    // 3. Получаем временную ссылку
			    return fetch(`/api/profile/${profileId}/temp-links`, {
				headers: {
				    "X-CSRFToken": getCookie("csrftoken"),
				},
			    })
			    .then(response => response.json())
			    .then(tempLinksData => {
				// 4. Получаем токены
				return fetch(`/api/profile/${profileId}/tokens`, {
				    headers: {
				        "X-CSRFToken": getCookie("csrftoken"),
				    },
				})
				.then(response => response.json())
				.then(tokensData => {
				    // Обрабатываем все полученные данные
				    return {
				        userId: profileId,
				        sessions: sessionsData,
				        tempLinks: tempLinksData,
				        tokens: tokensData
				    };
				});
			    });
			});
		    })
		    .then(profileData => {
			// Обрабатываем токены
			if (profileData.tokens) {
			    document.getElementById("telegramBotToken").value = profileData.tokens.telegramBotToken || "";
			    document.getElementById("telegramChatId").value = profileData.tokens.telegramChatId || "";
			    document.getElementById("vkGroupToken").value = profileData.tokens.vkGroupToken || "";
			    document.getElementById("vkUserToken").value = profileData.tokens.vkUserToken || "";
			    document.getElementById("okGroupToken").value = profileData.tokens.okGroupToken || "";

			    originalTokens = {
				telegramBotToken: profileData.tokens.telegramBotToken || "",
				telegramChatId: profileData.tokens.telegramChatId || "",
				vkGroupToken: profileData.tokens.vkGroupToken || "",
				vkUserToken: profileData.tokens.vkUserToken || "",
				okGroupToken: profileData.tokens.okGroupToken || "",
			    };
			}

			// Обрабатываем сессии
			if (profileData.sessions?.sessions) {
			    renderSessions(profileData.sessions.sessions);
			}

			// Обрабатываем временную ссылку
			if (profileData.tempLinks?.link) {
			    temporaryLinkInput.value = profileData.tempLinks.link;
			    const expiresAt = new Date(profileData.tempLinks.expires_at);
			    linkExpirationInfo.textContent = `Ссылка действительна до: ${expiresAt.toLocaleString()}`;
			    linkId = profileData.tempLinks.linkId;
			    revokeLinkBtn.style.display = "block";
			}
		    })
		    .catch(error => {
			console.error("Error loading profile data:", error);
		    });
		}

                // Отрисовка списка сессий
                function renderSessions(sessions) {
                    const sessionsList = document.getElementById("sessionsList");
                    sessionsList.innerHTML = "";

                    sessions.forEach((session) => {
                        const sessionElement = document.createElement("div");
                        sessionElement.className = "session-item";

                        // Форматируем даты
                        const startedDate = new Date(session.started_at);
                        const lastAccessDate = new Date(session.last_accessed);

                        sessionElement.innerHTML = `
                        <div class="session-details">
                            <div class="session-detail">
                                <span class="session-detail-label">Started:</span>
                                <span>${startedDate.toLocaleString()}</span>
                            </div>
                            <div class="session-detail">
                                <span class="session-detail-label">Last access:</span>
                                <span>${lastAccessDate.toLocaleString()}</span>
                            </div>
                            <div class="session-detail">
                                <span class="session-detail-label">IP address:</span>
                                <span>${session.ip_address}</span>
                            </div>
                            <div class="session-detail">
                                <span class="session-detail-label">Device:</span>
                                <span>-</span>
                            </div>
                        </div>
                        <button class="terminate-session-btn" data-session-id="${session.session_id}">
                            Закрыть сессию
                        </button>
                    `;

                        sessionsList.appendChild(sessionElement);
                    });

                    // Добавляем обработчики для кнопок закрытия сессии
                    document.querySelectorAll(".terminate-session-btn").forEach((btn) => {
                        btn.addEventListener("click", function () {
                            const sessionId = this.getAttribute("data-session-id");
                            terminateSession(sessionId);
                        });
                    });
                }

                // Закрытие сессии
                function terminateSession(sessionId) {
                    if (confirm("Вы уверены, что хотите закрыть эту сессию?")) {
                        fetch(`/api/profile/${profileId}/sessions/${sessionId}`, {
                            method: "DELETE",
                            headers: {
                                "X-CSRFToken": getCookie("csrftoken"),
                            },
                        })
                            .then((response) => response.json())
                            .then((data) => {
                                if (data.success) {
                                    loadProfileData(); // Перезагружаем данные
                                    alert("Сессия успешно закрыта");
                                } else {
                                    alert("Ошибка при закрытии сессии");
                                }
                            })
                            .catch((error) => {
                                console.error("Error terminating session:", error);
                                alert("Произошла ошибка при закрытии сессии");
                            });
                    }
                }

                // Изменение токенов
                tokenInputs.forEach((input) => {
                    input.addEventListener("input", function () {
                        const currentTokens = {
                            telegramBotToken: document.getElementById("telegramBotToken").value,
                            telegramChatId: document.getElementById("telegramChatId").value,
                            vkGroupToken: document.getElementById("vkGroupToken").value,
                            vkUserToken: document.getElementById("vkUserToken").value,
                            okGroupToken: document.getElementById("okGroupToken").value,
                        };

                        const hasChanges =
                            currentTokens.telegramBotToken !== originalTokens.telegramBotToken ||
                            currentTokens.telegramChatId !== originalTokens.telegramChatId ||
                            currentTokens.vkGroupToken !== originalTokens.vkGroupToken ||
                            currentTokens.vkUserToken !== originalTokens.vkUserToken ||
                            currentTokens.okGroupToken !== originalTokens.okGroupToken;

                        saveTokensBtn.style.display = hasChanges ? "block" : "none";
                    });
                });

                // Сохранение токенов
                saveTokensBtn.addEventListener("click", function () {
                    const tokens = {
                        telegramBotToken: document.getElementById("telegramBotToken").value,
                        telegramChatId: document.getElementById("telegramChatId").value,
                        vkGroupToken: document.getElementById("vkGroupToken").value,
                        vkUserToken: document.getElementById("vkUserToken").value,
                        okGroupToken: document.getElementById("okGroupToken").value,
                    };

                    // Создаем URL-encoded форму
                    const formData = new URLSearchParams();
                    formData.append("telegramBotToken", tokens.telegramBotToken);
                    formData.append("telegramChatId", tokens.telegramChatId);
                    formData.append("vkGroupToken", tokens.vkGroupToken);
                    formData.append("vkUserToken", tokens.vkUserToken);
                    formData.append("okGroupToken", tokens.okGroupToken);

                    fetch(`/api/profile/${profileId}/tokens`, {
                        method: "PUT",
                        headers: {
                            "Content-Type": "application/x-www-form-urlencoded",
                            "X-CSRFToken": getCookie("csrftoken"),
                        },
                        body: formData,
                    })
                        .then((response) => {
                           if (response.ok) {
                                alert("Токены успешно обновлены!");
                                originalTokens = tokens;
                                saveTokensBtn.style.display = "none";
                            } else {
                                alert("Ошибка при обновлении токенов: " + (data.error || ""));
                            }
                        })
                        .catch((error) => {
                            console.error("Error:", error);
                            alert("Произошла ошибка при обновлении токенов");
                        });
                });

                // Смена пароля
                changePasswordBtn.addEventListener("click", function () {
                    newPasswordInput.value = "";
                    passwordModal.style.display = "flex";
                });

                // Модальное окно смены пароля
                cancelPasswordBtn.addEventListener("click", function () {
                    passwordModal.style.display = "none";
                });

                confirmPasswordBtn.addEventListener("click", function () {
                    // Установка нового пароля
                    const newPassword = newPasswordInput.value.trim();

                    if (!newPassword) {
                        alert("Введите новый пароль");
                        return;
                    }

                    if (newPassword.length < 8) {
                        alert("Пароль должен содержать минимум 8 символов");
                        return;
                    }

                    // Обновление пароля через Keycloak
                    updatePassword(newPassword)
                        .then((success) => {
                            if (success) {
                                alert("Пароль успешно изменен!");
                                passwordModal.style.display = "none";
                            } else {
                                alert("Ошибка при изменении пароля");
                            }
                        })
                        .catch((error) => {
                            console.error("Error updating password:", error);
                            alert("Произошла ошибка при изменении пароля");
                        });
                });

                // Обновление пароля через Keycloak
                function updatePassword(newPassword) {
                    // Создаем URL-encoded форму
                    const formData = new URLSearchParams();
                    formData.append("new_password", newPassword);

                    return fetch(`/api/profile/${profileId}/change_password`, {
                        method: "PUT",
                        headers: {
                            "Content-Type": "application/x-www-form-urlencoded",
                            "X-CSRFToken": getCookie("csrftoken"),
                        },
                        body: formData,
                    })
                        .then((response) => response.json())
                }

                // Редактирование поста
                editPostBtn.addEventListener("click", function () {
                    sessionStorage.setItem(
                        "editPostData",
                        JSON.stringify({
                            // Здесь можно сохранить данные для редактирования поста
                        })
                    );

                    window.location.href = "/";
                });

                // Назад
                backBtn.addEventListener("click", function () {
                    window.history.back();
                });

                // Закрытие сессии
                terminateSessionBtns.forEach((btn) => {
                    btn.addEventListener("click", function () {
                        const sessionItem = this.closest(".session-item");
                        const browserInfo = sessionItem.querySelector(".session-browser").textContent;

                        if (confirm(`Вы уверены, что хотите закрыть сессию "${browserInfo}"?`)) {
                            // Здесь должен быть код для закрытия сессии на сервере
                            // Пока просто удаляем элемент из DOM
                            sessionItem.remove();
                            alert("Сессия успешно закрыта");
                        }
                    });
                });

                // Вспомогательная функция для получения CSRF токена
                function getCookie(name) {
                    let cookieValue = null;
                    if (document.cookie && document.cookie !== "") {
                        const cookies = document.cookie.split(";");
                        for (let i = 0; i < cookies.length; i++) {
                            const cookie = cookies[i].trim();
                            if (cookie.substring(0, name.length + 1) === name + "=") {
                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                break;
                            }
                        }
                    }
                    return cookieValue;
                }

                // Загрузка данных при открытии страницы
                loadProfileData();
            });
        </script>
    </body>

    <script src="static/bootstrap-5.3.2-dist/js/jquery3.7.1.js"></script>
    <script src="static/bootstrap-5.3.2-dist/js/bootstrap.bundle.min.js"></script>
    <script src="static/app.js"></script>
</html>

